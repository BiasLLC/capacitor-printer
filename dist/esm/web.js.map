{"version":3,"file":"web.js","sourceRoot":"","sources":["../../src/web.ts"],"names":[],"mappings":"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","sourcesContent":["import { WebPlugin } from '@capacitor/core';\n\nimport type {\n  PrintBase64Options,\n  PrintFileOptions,\n  PrintHtmlOptions,\n  PrintOptions,\n  PrintPdfOptions,\n  PrinterPlugin,\n} from './definitions';\n\nexport class PrinterWeb extends WebPlugin implements PrinterPlugin {\n  async printBase64(options: PrintBase64Options): Promise<void> {\n    const { data, mimeType, name } = options;\n\n    // Convert base64 to blob\n    const byteCharacters = atob(data);\n    const byteNumbers = new Array(byteCharacters.length);\n    for (let i = 0; i < byteCharacters.length; i++) {\n      byteNumbers[i] = byteCharacters.charCodeAt(i);\n    }\n    const byteArray = new Uint8Array(byteNumbers);\n    const blob = new Blob([byteArray], { type: mimeType });\n\n    // Create object URL and print\n    const url = URL.createObjectURL(blob);\n    await this.printFromUrl(url, name);\n    URL.revokeObjectURL(url);\n  }\n\n  async printFile(options: PrintFileOptions): Promise<void> {\n    const { path, name } = options;\n\n    // On web, we can only print URLs that are accessible\n    // This will work for file:// URLs in some browsers or HTTP(S) URLs\n    await this.printFromUrl(path, name);\n  }\n\n  async printHtml(options: PrintHtmlOptions): Promise<void> {\n    const { html, name } = options;\n\n    // Create a blob URL from the HTML content\n    const blob = new Blob([html], { type: 'text/html' });\n    const url = URL.createObjectURL(blob);\n    await this.printFromUrl(url, name);\n    URL.revokeObjectURL(url);\n  }\n\n  async printPdf(options: PrintPdfOptions): Promise<void> {\n    const { path, name } = options;\n\n    // On web, print the PDF URL\n    await this.printFromUrl(path, name);\n  }\n\n  async printWebView(options?: PrintOptions): Promise<void> {\n    // Set document title for print job name\n    const originalTitle = document.title;\n    if (options?.name) {\n      document.title = options.name;\n    }\n\n    // Trigger browser print dialog\n    window.print();\n\n    // Restore original title\n    document.title = originalTitle;\n  }\n\n  async getPluginVersion(): Promise<{ version: string }> {\n    return { version: '7.0.0' };\n  }\n\n  private async printFromUrl(url: string, name?: string): Promise<void> {\n    return new Promise((resolve, reject) => {\n      // Create hidden iframe\n      const iframe = document.createElement('iframe');\n      iframe.style.position = 'fixed';\n      iframe.style.right = '0';\n      iframe.style.bottom = '0';\n      iframe.style.width = '0';\n      iframe.style.height = '0';\n      iframe.style.border = 'none';\n\n      // Set up load handler\n      iframe.onload = () => {\n        try {\n          // Set document title if name provided\n          if (name && iframe.contentDocument) {\n            iframe.contentDocument.title = name;\n          }\n\n          // Small delay to ensure content is loaded\n          setTimeout(() => {\n            try {\n              // Try to access the iframe's window\n              const iframeWindow = iframe.contentWindow;\n              if (!iframeWindow) {\n                throw new Error('Cannot access iframe window');\n              }\n\n              // Print the iframe content\n              iframeWindow.focus();\n              iframeWindow.print();\n\n              // Clean up after a delay\n              setTimeout(() => {\n                document.body.removeChild(iframe);\n                resolve();\n              }, 100);\n            } catch (error) {\n              document.body.removeChild(iframe);\n              reject(error);\n            }\n          }, 100);\n        } catch (error) {\n          document.body.removeChild(iframe);\n          reject(error);\n        }\n      };\n\n      iframe.onerror = () => {\n        document.body.removeChild(iframe);\n        reject(new Error('Failed to load content for printing'));\n      };\n\n      // Add iframe to document and set source\n      document.body.appendChild(iframe);\n      iframe.src = url;\n    });\n  }\n}\n"]}